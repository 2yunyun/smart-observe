!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("ob",e):t.ob=e()}(this,function(){"use strict";function t(t,e,n,i){Object.defineProperty(t,e,{value:n,enumerable:!!i,writable:!0,configurable:!0})}function e(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,configurable:!0,enumerable:!0})}function n(t){return H.call(t)===J}function i(t){return null!==t&&"object"===("undefined"==typeof t?"undefined":E(t))}function o(t){return"function"==typeof t}function r(t,e){for(var n=Object.keys(t),i=0,o=n.length;i<o;i++)e(n[i],t[n[i]])}function u(){}function s(t){Object.setPrototypeOf(t,U)}function a(t,e){return t>=this.length&&(this.length=Number(t)+1),this.splice(t,1,e)[0]}function c(t){if(this.length){var e=this.indexOf(t);return e>-1?this.splice(e,1):void 0}}function f(t){if(t&&"object"===("undefined"==typeof t?"undefined":E(t))){var e=void 0;return Object.prototype.hasOwnProperty.call(t,C)&&t[C]instanceof tt?e=t[C]:(B(t)||n(t))&&Object.isExtensible(t)&&(e=new tt(t)),e}}function l(t,n,i){function o(){var e=a?a.call(t):i;if(M.target&&(u.depend(),l&&l.dep.depend(),B(e)))for(var n,o=0,r=e.length;o<r;o++)n=e[o],n&&n[C]&&n[C].dep.depend();return e}function r(e){var n=a?a.call(t):i;e!==n&&(c?c.call(t,e):i=e,l=f(e),u.notify())}var u=new M,s=Object.getOwnPropertyDescriptor(t,n);if(!s||s.configurable!==!1){var a=s&&s.get,c=s&&s.set,l=f(i);e(t,n,o,r)}}function h(t){try{return new Function("scope","return "+t+";")}catch(e){K("Invalid expression. Generated function body: "+t)}}function d(t){return t=String.prototype.trim.call(t),h("scope."+t)}function p(){et=[],nt={},it=!1}function v(){y(et),p()}function y(t){for(ot=0;ot<t.length;ot++){var e=t[ot],n=e.id;nt[n]=null,e.run()}}function b(t){var e=t.id;null==nt[e]&&(nt[e]=et.length,et.push(t),it||(it=!0,rt(v)))}function w(t){var e=void 0,n=void 0;if(B(t))for(e=t.length;e--;)w(t[e]);else if(i(t))for(n=Object.keys(t),e=n.length;e--;)w(t[n[e]])}function g(t,e,n,i){var r=o(e)?e:d(e);return new st(t,r,n,i)}function m(t,e){var n=new st(t,e,null,{deep:k.deep,lazy:!0,sync:k.sync});return function(){return n.options.lazy&&M.target&&!M.target.options.lazy&&(n.options.lazy=!1,n.callback=function(){for(var t=n.deps,e=0,i=t.length;e<i;e++)t[e].notify()}),n.dirty&&n.evaluate(),M.target&&n.depend(),n.value}}function k(t,e,n,i){return t.hasOwnProperty(F)||D(t),k.default(t,e,n,i)}function O(t,e){return e?e.hasOwnProperty(F)||D(e):(e={},D(e)),t.methods&&_(e,t.methods),t.data&&P(e,t.data),t.computed&&z(e,t.computed),t.watchers&&A(e,t.watchers),e}function j(t,n,i,r){t.hasOwnProperty(F)||D(t);var s=void 0,a=void 0;o(i)?(s=r!==!1?m(t,i):i.bind(this),a=u):(s=i.get?i.cache!==!1||r!==!1?m(t,i.get):i.get.bind(this):u,a=i.set?i.set.bind(this):u),e(t,n,s,a)}function S(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;return t.hasOwnProperty(F)||D(t),g(t,e,n,i)}function D(e){t(e,F,[],!1),t(e,V,Object.create(null),!1),f(e[V]),x(e)}function _(t,e){r(e,function(e,n){t[e]=n.bind(t)})}function I(t,e,n){t[V][e]=n,l(t[V],e,n),G(t,e)}function P(t,e){r(e,function(e,n){return I(t,e,n)})}function x(t){r(t,function(e,n){!o(n)&&I(t,e,n)})}function z(t,e){r(e,function(e,n){return j(t,e,n)})}function A(t,e){r(e,function(e,n){o(n)?S(t,e,n):S(t,e,n.watcher,n)})}function G(t,n){function i(){return t[V][n]}function o(e){t[V][n]=e}e(t,n,i,o)}var E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N=(function(){function t(t){this.value=t}function e(e){function n(t,e){return new Promise(function(n,o){var s={key:t,arg:e,resolve:n,reject:o,next:null};u?u=u.next=s:(r=u=s,i(t,e))})}function i(n,r){try{var u=e[n](r),s=u.value;s instanceof t?Promise.resolve(s.value).then(function(t){i("next",t)},function(t){i("throw",t)}):o(u.done?"return":"normal",u.value)}catch(t){o("throw",t)}}function o(t,e){switch(t){case"return":r.resolve({value:e,done:!0});break;case"throw":r.reject(e);break;default:r.resolve({value:e,done:!1})}r=r.next,r?i(r.key,r.arg):u=null}var r,u;this._invoke=n,"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new e(t.apply(this,arguments))}},await:function(e){return new t(e)}}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),T=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),$=0,M=function(){function t(){N(this,t),this.id=$++,this.subs=[]}return T(t,[{key:"addSub",value:function(t){this.subs.push(t)}},{key:"removeSub",value:function(t){this.subs.$remove(t)}},{key:"depend",value:function(){t.target.addDep(this)}},{key:"notify",value:function(){for(var t=this.subs,e=0,n=t.length;e<n;e++)t[e].update()}}]),t}();M.target=null;var C="__ob__",F="__watchers__",V="__data__",q="undefined"!=typeof process&&"production"!==process.env.NODE_ENV,B=Array.isArray,H=Object.prototype.toString,J="[object Object]",K=q&&console&&o(console.warn)?console.warn:u,L=void 0;"undefined"!=typeof Set&&Set.toString().match(/native code/)?L=Set:(L=function(){this.set=Object.create(null)},L.prototype.has=function(t){return void 0!==this.set[t]},L.prototype.add=function(t){this.set[t]=1},L.prototype.clear=function(){this.set=Object.create(null)});for(var Q,R=Array.prototype,U=Object.create(R),W=["push","pop","shift","unshift","splice","sort","reverse"],X=function(e,n,i){var o=R[i];t(U,i,function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=o.apply(this,e),u=this[C],s=void 0;switch(i){case"push":s=e;break;case"unshift":s=e;break;case"splice":s=e.slice(2)}return s&&u.observeArray(s),u.dep.notify(),r})},Y=0,Z=W.length;Y<Z;Q=W[++Y])X(Y,Z,Q);t(R,"$set",a),t(R,"$remove",c);var tt=function(){function e(n){N(this,e),this.value=n,this.dep=new M,t(n,C,this),B(n)?(s(n),this.observeArray(n)):this.walk(n)}return T(e,[{key:"walk",value:function(t){var e=this;r(t,function(t,n){return e.convert(t,n)})}},{key:"observeArray",value:function(t){for(var e=0,n=t.length;e<n;e++)f(t[e])}},{key:"convert",value:function(t,e){l(this.value,t,e)}}]),e}(),et=[],nt={},it=!1,ot=void 0,rt=function(){function t(){n=!1;var t=e.slice(0);e=[];for(var i=0;i<t.length;i++)t[i]()}var e=[],n=!1,i=void 0;if("undefined"!=typeof MutationObserver)!function(){var e=1,n=new MutationObserver(t),o=document.createTextNode(e);n.observe(o,{characterData:!0}),i=function(){e=(e+1)%2,o.data=e}}();else{var o="undefined"!=typeof window&&"[object Object]"!==Object.prototype.toString.call(window),r=o?window:"undefined"!=typeof global?global:{};i=r.setImmediate||setTimeout}return function(o,r){var u=r?function(){o.call(r)}:o;e.push(u),n||(n=!0,i(t,0))}}(),ut=0,st=function(){function t(e,n,i,o){N(this,t),e[F].push(this),this.owner=e,this.getter=n,this.callback=i,this.options=o,this.id=++ut,this.active=!0,this.dirty=o.lazy,this.deps=[],this.newDeps=[],this.depIds=new L,this.newDepIds=new L,this.value=o.lazy?void 0:this.get()}return T(t,[{key:"get",value:function(){this.beforeGet();var t=this.owner,e=this.getter.call(t,t);return this.options.deep&&w(e),this.afterGet(),e}},{key:"beforeGet",value:function(){M.target=this}},{key:"addDep",value:function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))}},{key:"afterGet",value:function(){M.target=null;for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0}},{key:"update",value:function(){this.options.lazy?this.dirty=!0:this.options.sync?this.run():b(this)}},{key:"run",value:function(){if(this.active){var t=this.get();if(t!==this.value||i(t)||this.options.deep){var e=this.value;this.value=t,this.callback.call(this.owner,t,e)}}}},{key:"evaluate",value:function(){var t=M.target;this.value=this.get(),this.dirty=!1,M.target=t}},{key:"depend",value:function(){for(var t=this.deps.length;t--;)this.deps[t].depend()}},{key:"teardown",value:function(){if(this.active){for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1,this.owner=this.callback=this.value=null}}}]),t}();return k.default=S,k.deep=k.lazy=k.sync=!1,Object.setPrototypeOf(k,{react:O,compute:j,watch:S}),k});
//# sourceMappingURL=ob.min.js.map
