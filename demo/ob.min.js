!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("ob",e):t.ob=e()}(this,function(){"use strict";function t(t,e,n,o){Object.defineProperty(t,e,{value:n,enumerable:!!o,writable:!0,configurable:!0})}function e(t,e,n,o){Object.defineProperty(t,e,{get:n,set:o,configurable:!0,enumerable:!0})}function n(t){return q.call(t)===B}function o(t,e){for(var n=t.length;n--;)if(t[n]===e)return n;return-1}function i(t){return null!==t&&"object"===("undefined"==typeof t?"undefined":F(t))}function r(t,e){for(var n=Object.keys(t),o=0,i=n.length;o<i;o++)e(n[o],t[n[o]])}function s(t,e){for(var n=0,o=t.length;n<o;n++)e(t[n],n)}function u(t){return"function"==typeof t}function c(){}function a(){this.id=J++,this.subs=[]}function f(t){Object.setPrototypeOf(t,L)}function p(t,e){return t>=this.length&&(this.length=Number(t)+1),this.splice(t,1,e)[0]}function h(t){if(this.length){var e=o(this,t);return e>-1?this.splice(e,1):void 0}}function d(e){this.value=e,this.dep=new a,t(e,"__ob__",this),V(e)?(f(e),this.observeArray(e)):this.walk(e)}function l(t){if(t&&"object"===("undefined"==typeof t?"undefined":F(t))){var e;return Object.prototype.hasOwnProperty.call(t,"__ob__")&&t.__ob__ instanceof d?e=t.__ob__:(V(t)||n(t))&&Object.isExtensible(t)&&(e=new d(t)),e}}function v(t,n,o){function i(){var e=f?f.call(t):o;return a.target&&(u.depend(),h&&h.dep.depend(),V(e)&&s(e,function(t){t&&t.__ob__&&t.__ob__.dep.depend()})),e}function r(e){var n=f?f.call(t):o;e!==n&&(p?p.call(t,e):o=e,h=l(e),u.notify())}var u=new a,c=Object.getOwnPropertyDescriptor(t,n);if(!c||c.configurable!==!1){var f=c&&c.get,p=c&&c.set,h=l(o);e(t,n,i,r)}}function y(t){try{return new Function("scope","return "+t+";")}catch(e){H("Invalid expression. Generated function body: "+t)}}function b(t){t=t.trim();var e=y("scope."+t);return e}function w(){U=[],W={},X=!1}function g(){_(U),w()}function _(t){for(R=0;R<t.length;R++){var e=t[R],n=e.id;W[n]=null,e.run()}}function m(t){var e=t.id;null==W[e]&&(W[e]=U.length,U.push(t),X||(X=!0,Y(g)))}function O(t,e,n,o){t._watchers.push(this),this.owner=t,this.getter=e,this.callback=n,this.options=o,this.id=++Z,this.active=!0,this.dirty=o.lazy,this.deps=[],this.newDeps=[],this.depIds=Object.create(null),this.newDepIds=null,this.value=o.lazy?void 0:this.get()}function j(t){var e,n;if(V(t))for(e=t.length;e--;)j(t[e]);else if(i(t))for(n=Object.keys(t),e=n.length;e--;)j(t[n[e]])}function D(t,e,n,o){var i=u(e)?e:b(e),r=new O(t,i,n,o);return r}function I(t,e){var n=new O(t,e,null,{lazy:!0});return function(){return n.dirty&&n.evaluate(),a.target&&n.depend(),n.value}}function S(t,e,n,o){tt=t;var i=t.hasOwnProperty("_watchers");return i||(k(t),A.auto&&A()),e&&S["default"](e,n,o),S}function k(e){return t(e,"_watchers",[],!1),t(e,"_data",Object.create(null),!1),l(e._data),S}function A(t){return t?(t.methods&&$(t.methods),t.data&&z(t.data),t.computed&&N(t.computed),t.watchers&&M(t.watchers)):r(tt,function(t,e){!u(e)&&x(t,e)}),S}function P(t,e){return tt[t]=e.bind(tt),S}function $(t){return r(t,function(t,e){P(t,e)}),S}function x(t,e){return tt._data[t]=e,v(tt._data,t,e),T(tt,t),S}function z(t){return r(t,function(t,e){x(t,e)}),S}function G(t,n,o){var i,r;u(n)?(i=I(tt,n),r=c):(i=n.get?o!==!1?I(tt,n.get):n.get.bind(this):c,r=n.set?n.set.bind(this):c),e(tt,t,i,r)}function N(t){return r(t,function(t,e){G(t,e)}),S}function E(t,e,n){return D(tt,t,e,n||E)}function M(t){return r(t,function(t,e){u(e)?E(t,e):E(t,e.watcher,e)}),S}function T(t,n){function o(){return t._data[n]}function i(e){t._data[n]=e}e(t,n,o,i)}var F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},V=Array.isArray,q=Object.prototype.toString,B="[object Object]",C="undefined"!=typeof process&&"production"!==process.env.NODE_ENV,H=C&&console&&u(console.warn)?console.warn:c,J=0;a.target=null,a.prototype.addSub=function(t){this.subs.push(t)},a.prototype.removeSub=function(t){this.subs.$remove(t)},a.prototype.depend=function(){a.target.addDep(this)},a.prototype.notify=function(){var t=this.subs;s(t,function(t){t.update()})};var K=Array.prototype,L=Object.create(K),Q=["push","pop","shift","unshift","splice","sort","reverse"];s(Q,function(e){var n=K[e];t(L,e,function(){for(var t=arguments.length,o=new Array(t);t--;)o[t]=arguments[t];var i,r=n.apply(this,o),s=this.__ob__;switch(e){case"push":i=o;break;case"unshift":i=o;break;case"splice":i=o.slice(2)}return i&&s.observeArray(i),s.dep.notify(),r})}),t(K,"$set",p),t(K,"$remove",h),d.prototype.walk=function(t){var e=this;r(t,function(t,n){e.convert(t,n)})},d.prototype.observeArray=function(t){s(t,function(t){l(t)})},d.prototype.convert=function(t,e){v(this.value,t,e)};var R,U=[],W={},X=!1,Y=function(){function t(){o=!1;var t=n.slice(0);n=[];for(var e=0;e<t.length;e++)t[e]()}var e,n=[],o=!1;if("undefined"!=typeof MutationObserver){var i=1,r=new MutationObserver(t),s=document.createTextNode(i);r.observe(s,{characterData:!0}),e=function(){i=(i+1)%2,s.data=i}}else{var u="undefined"!=typeof window&&"[object Object]"!==Object.prototype.toString.call(window),c=u?window:"undefined"!=typeof global?global:{};e=c.setImmediate||setTimeout}return function(i,r){var s=r?function(){i.call(r)}:i;n.push(s),o||(o=!0,e(t,0))}}(),Z=0;O.prototype.get=function(){this.beforeGet();var t=this.owner,e=this.getter.call(t,t);return this.options.deep&&j(e),this.afterGet(),e},O.prototype.beforeGet=function(){a.target=this,this.newDepIds=Object.create(null),this.newDeps.length=0},O.prototype.addDep=function(t){var e=t.id;this.newDepIds[e]||(this.newDepIds[e]=!0,this.newDeps.push(t),this.depIds[e]||t.addSub(this))},O.prototype.afterGet=function(){a.target=null;for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds[e.id]||e.removeSub(this)}this.depIds=this.newDepIds;var n=this.deps;this.deps=this.newDeps,this.newDeps=n},O.prototype.update=function(){this.options.lazy?this.dirty=!0:this.options.sync?this.run():m(this)},O.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||i(t)||this.options.deep){var e=this.value;this.value=t,this.callback.call(this.owner,t,e)}}},O.prototype.evaluate=function(){var t=a.target;this.value=this.get(),this.dirty=!1,a.target=t},O.prototype.depend=function(){for(var t=this.deps.length;t--;)this.deps[t].depend()},O.prototype.teardown=function(){if(this.active){for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1,this.owner=this.callback=this.value=null}};var tt=null;return S["default"]=E,A.auto=!0,E.deep=E.lazy=E.sync=!1,Object.setPrototypeOf(S,{reactive:A,carry:P,$carry:$,react:x,$react:z,compute:G,$compute:N,watch:E,$watch:M}),S});
//# sourceMappingURL=ob.min.js.map